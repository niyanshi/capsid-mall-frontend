import{_ as q}from"./gold.bdd5daf4.js";import{d as L,u as P,bU as W,y as j,r as c,f as $,o as _,c as p,b as s,t as o,e as i,F as E,h as G,j as D,C as S,g as O,q as z,s as H,A as J,_ as K}from"./index.21f0358c.js";import{B as Q}from"./index.2f5b3fba.js";import{b as X}from"./campaign.e0699e2c.js";import{u as Z,b as ss}from"./useSeaport.2a089d37.js";import{d as es}from"./dayjs.min.1ba1cbc9.js";import{P as ts}from"./index.4ff6959e.js";import"./icon-add.d86e97f0.js";import"./nft.2142c28f.js";import"./profile.e2067de0.js";const n=v=>(z("data-v-49b67185"),v=v(),H(),v),os={class:"wrap"},as={class:"title"},is=n(()=>s("img",{src:q,alt:""},null,-1)),ns={class:"info-wrap"},ls=["src"],cs={class:"text"},ds={class:"desc"},us={class:"price"},rs=n(()=>s("span",{class:"icon-price"},null,-1)),_s=n(()=>s("span",{class:"button-icon nft-money"},null,-1)),ps=["src"],vs={class:"text"},ms={class:"desc"},hs={class:"price"},gs=n(()=>s("span",{class:"icon-price"},null,-1)),bs={class:"expire"},ys={class:"expire-date mb41"},ks=n(()=>s("span",{class:"start-icon calendar-icon"},null,-1)),Is={class:"expire-date"},Cs=n(()=>s("span",{class:"start-icon book-icon"},null,-1)),xs=["onClick"],ws=n(()=>s("span",{class:"button-icon nfr-money"},null,-1)),fs={key:0,class:"tip-content"},Ns=n(()=>s("i",{class:"icon-success icon"},null,-1)),Ds={class:"info-text"},Ss={class:"info-title"},Ts={class:"message"},Bs={key:1,class:"tip-content"},Rs=n(()=>s("i",{class:"icon-error icon"},null,-1)),As={class:"info-text"},Fs={class:"info-title"},Vs={class:"message"},Ms=n(()=>s("i",{class:"icon-ok"},null,-1)),Us=L({__name:"index",setup(v){const{buyNFR:T}=Z(),{t:l}=P(),y=W(),x=j(),k=c(),I=c(),d=c(),w=c([]),C=c(),m=c(!1),h=c(!1),f=c(!1),B=async()=>{if(!k.value)return;const t=await X({campaignId:k.value});t.code===0&&(d.value=t.data.nfts.find(a=>a.tokenId===I.value),w.value=t.data.nfrs.filter(a=>a.nftId===I.value))},R=(t,a)=>a-t,A=t=>{m.value=!0,C.value={image:t.imageUrl,tokenId:t.tokenId,type:1,tokenAddress:t.contractAddress}},F=async t=>{try{if(!x.currentUser.isLogin){x.setLoginModalVisible(!0);return}const{orderOnChain:a,id:g}=t,u=1,r=await ss(String(g),u);if(r.code!==0)return;const b=r.data.nfrTrans.nfrTokenId;if(!await T({order:a,orderId:b,amount:u}))return;m.value=!0,C.value={image:t.image,tokenId:t.nfrTokenId,type:2,tokenAddress:t.nfrTokenAddress}}catch(a){J.error(a.message)}},N=()=>{m.value=!1},V=t=>{f.value=t,h.value=!0},M=()=>{h.value=!1},U=()=>{h.value=!1,N()};return $(()=>{y.query.campaignId&&(k.value=Number(y.query.campaignId),B()),I.value=y.params.id}),(t,a)=>{var g,u,r,b;return _(),p("div",os,[s("div",as,[is,s("span",null,o((g=d.value)==null?void 0:g.name),1)]),s("div",ns,[s("img",{src:(u=d.value)==null?void 0:u.imageUrl,alt:""},null,8,ls),s("div",cs,[s("div",ds,o((r=d.value)==null?void 0:r.description),1),s("div",us,[rs,s("span",null,o((b=d.value)==null?void 0:b.price),1)]),s("div",{class:"buy-button nft",onClick:a[0]||(a[0]=e=>A(d.value))},[s("span",null,o(i(l)("buyNft")),1),_s])])]),(_(!0),p(E,null,G(w.value,(e,Y)=>(_(),p("div",{key:Y,class:"info-wrap"},[s("img",{src:e==null?void 0:e.image,alt:""},null,8,ps),s("div",vs,[s("div",ms,o(e==null?void 0:e.description),1),s("div",hs,[gs,s("span",null,o(e==null?void 0:e.unitPrice),1)]),s("div",bs,[s("div",ys,[ks,s("span",null,o(i(es)(e==null?void 0:e.createdAt).add(e==null?void 0:e.duration,"day").format("DD/MM/YYYY")),1)]),s("div",Is,[Cs,s("span",null,o(R(e==null?void 0:e.selledAmount,e==null?void 0:e.amount)+"/"+(e==null?void 0:e.amount)),1)])]),s("div",{class:"buy-button nfr",onClick:Ys=>F(e)},[s("span",null,o(i(l)("buyNfr")),1),ws],8,xs)])]))),128)),D(ts,{visible:m.value,"item-to-wear":C.value,onClose:N,onResult:V},null,8,["visible","item-to-wear"]),D(Q,{visible:h.value,width:"640",height:"240",onClose:M},{button:S(()=>[s("div",{class:"dialog-button",onClick:U},[s("span",null,o(i(l)("ok")),1),Ms])]),default:S(()=>[f.value?(_(),p("div",fs,[Ns,s("div",Ds,[s("div",Ss,o(i(l)("wearSuccess")),1),s("div",Ts,[s("p",null,[O(o(i(l)("viewInMy")),1),s("a",null,o(i(l)("profile")),1)]),s("p",null,o(i(l)("wearSuccessTips")),1)])])])):(_(),p("div",Bs,[Rs,s("div",As,[s("div",Fs,o(i(l)("error")),1),s("div",Vs,[s("p",null,o(i(l)("errorTips")),1)])])]))]),_:1},8,["visible"])])}}});const Hs=K(Us,[["__scopeId","data-v-49b67185"]]);export{Hs as default};
