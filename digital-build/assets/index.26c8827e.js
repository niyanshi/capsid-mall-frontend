import{I as ae,a as re,B as oe,b as W}from"./buy.1dfa4eb4.js";import{u as ce,d as de,e as le,a as ue,f as fe,b as pe}from"./useSeaport.2a089d37.js";import{c as ve}from"./compass.33c07fc0.js";import{bG as me,bH as ge,bI as E,bJ as _e,d as M,bK as he,bx as ye,bL as be,bC as Se,bM as xe,bN as q,bO as G,j as S,bP as Ie,bQ as k,bR as Y,bS as Ne,bT as H,u as Z,o as B,c as A,b as c,t as N,e as I,g as U,F as ee,h as ke,n as Ce,_ as te,y as Te,z as $e,a as Re,r as L,f as we,C as K,i as Le,v as Ue,q as Be,s as Pe,A as Ae}from"./index.21f0358c.js";import{d as ne}from"./dayjs.min.1ba1cbc9.js";import{b as De}from"./explore.bf4a14db.js";var Fe="[object Symbol]";function Oe(t){return typeof t=="symbol"||me(t)&&ge(t)==Fe}var Ee=/\s/;function Me(t){for(var e=t.length;e--&&Ee.test(t.charAt(e)););return e}var je=/^\s+/;function ze(t){return t&&t.slice(0,Me(t)+1).replace(je,"")}var J=0/0,Ve=/^[-+]0x[0-9a-f]+$/i,We=/^0b[01]+$/i,qe=/^0o[0-7]+$/i,Ge=parseInt;function Q(t){if(typeof t=="number")return t;if(Oe(t))return J;if(E(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=E(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=ze(t);var i=We.test(t);return i||qe.test(t)?Ge(t.slice(2),i?2:8):Ve.test(t)?J:+t}var Ye=function(){return _e.Date.now()};const O=Ye;var He="Expected a function",Ke=Math.max,Je=Math.min;function Qe(t,e,i){var s,y,x,l,o,p,m=0,d=!1,g=!1,_=!0;if(typeof t!="function")throw new TypeError(He);e=Q(e)||0,E(i)&&(d=!!i.leading,g="maxWait"in i,x=g?Ke(Q(i.maxWait)||0,e):x,_="trailing"in i?!!i.trailing:_);function h(n){var r=s,b=y;return s=y=void 0,m=n,l=t.apply(b,r),l}function T(n){return m=n,o=setTimeout(u,e),d?h(n):l}function w(n){var r=n-p,b=n-m,R=e-r;return g?Je(R,x-b):R}function $(n){var r=n-p,b=n-m;return p===void 0||r>=e||r<0||g&&b>=x}function u(){var n=O();if($(n))return C(n);o=setTimeout(u,w(n))}function C(n){return o=void 0,_&&s?h(n):(s=y=void 0,l)}function f(){o!==void 0&&clearTimeout(o),m=0,s=p=y=o=void 0}function v(){return o===void 0?l:C(O())}function a(){var n=O(),r=$(n);if(s=arguments,y=this,p=n,r){if(o===void 0)return T(p);if(g)return clearTimeout(o),o=setTimeout(u,e),h(p)}return o===void 0&&(o=setTimeout(u,e)),l}return a.cancel=f,a.flush=v,a}var Xe=["class","style"],Ze=function(){return{prefixCls:String,spinning:{type:Boolean,default:void 0},size:String,wrapperClassName:String,tip:H.any,delay:Number,indicator:H.any}},D=null;function et(t,e){return!!t&&!!e&&!isNaN(Number(e))}function tt(t){var e=t.indicator;D=typeof e=="function"?e:function(){return S(e,null,null)}}const P=M({compatConfig:{MODE:3},name:"ASpin",inheritAttrs:!1,props:he(Ze(),{size:"default",spinning:!0,wrapperClassName:""}),setup:function(){return{originalUpdateSpinning:null,configProvider:ye("configProvider",be)}},data:function(){var e=this.spinning,i=this.delay,s=et(e,i);return{sSpinning:e&&!s}},created:function(){this.originalUpdateSpinning=this.updateSpinning,this.debouncifyUpdateSpinning(this.$props)},mounted:function(){this.updateSpinning()},updated:function(){var e=this;Se(function(){e.debouncifyUpdateSpinning(),e.updateSpinning()})},beforeUnmount:function(){this.cancelExistingSpin()},methods:{debouncifyUpdateSpinning:function(e){var i=e||this.$props,s=i.delay;s&&(this.cancelExistingSpin(),this.updateSpinning=Qe(this.originalUpdateSpinning,s))},updateSpinning:function(){var e=this.spinning,i=this.sSpinning;i!==e&&(this.sSpinning=e)},cancelExistingSpin:function(){var e=this.updateSpinning;e&&e.cancel&&e.cancel()},renderIndicator:function(e){var i="".concat(e,"-dot"),s=xe(this,"indicator");return s===null?null:(Array.isArray(s)&&(s=s.length===1?s[0]:s),q(s)?G(s,{class:i}):D&&q(D())?G(D(),{class:i}):S("span",{class:"".concat(i," ").concat(e,"-dot-spin")},[S("i",{class:"".concat(e,"-dot-item")},null),S("i",{class:"".concat(e,"-dot-item")},null),S("i",{class:"".concat(e,"-dot-item")},null),S("i",{class:"".concat(e,"-dot-item")},null)]))}},render:function(){var e,i,s,y=this.$props,x=y.size,l=y.prefixCls,o=y.tip,p=o===void 0?(e=(i=this.$slots).tip)===null||e===void 0?void 0:e.call(i):o,m=y.wrapperClassName,d=this.$attrs,g=d.class,_=d.style,h=Ie(d,Xe),T=this.configProvider,w=T.getPrefixCls,$=T.direction,u=w("spin",l),C=this.sSpinning,f=(s={},k(s,u,!0),k(s,"".concat(u,"-sm"),x==="small"),k(s,"".concat(u,"-lg"),x==="large"),k(s,"".concat(u,"-spinning"),C),k(s,"".concat(u,"-show-text"),!!p),k(s,"".concat(u,"-rtl"),$==="rtl"),k(s,g,!!g),s),v=S("div",Y(Y({},h),{},{style:_,class:f}),[this.renderIndicator(u),p?S("div",{class:"".concat(u,"-text")},[p]):null]),a=Ne(this);if(a&&a.length){var n,r=(n={},k(n,"".concat(u,"-container"),!0),k(n,"".concat(u,"-blur"),C),n);return S("div",{class:["".concat(u,"-nested-loading"),m]},[C&&S("div",{key:"loading"},[v]),S("div",{class:r,key:"container"},[a])])}return v}});P.setDefaultIndicator=tt;P.install=function(t){return t.component(P.name,P),t};const X=""+new URL("remove.6c05c314.svg",import.meta.url).href,nt=""+new URL("link.20c2d00f.svg",import.meta.url).href,st=""+new URL("info.909ed97a.svg",import.meta.url).href,it={class:"info-box"},at={class:"desc"},rt={class:"link"},ot=["href"],ct=["src"],dt={class:"both"},lt={class:"item"},ut={class:"key"},ft={class:"val"},pt={class:"item"},vt={class:"key"},mt={class:"val"},gt={class:"expire"},_t=["src"],ht={class:"info"},yt={class:"item"},bt=["src"],St=["src"],xt={class:"item"},It=["src"],Nt={class:"btn-group"},kt=["onClick"],Ct=["src"],Tt=M({__name:"InfoBox",props:{data:null,btns:null},setup(t){const e=t,{t:i}=Z();return(s,y)=>{var x,l,o,p,m,d,g,_;return B(),A("div",it,[c("div",at,N((x=e.data)==null?void 0:x.desc),1),c("div",rt,[c("a",{href:(l=e.data)==null?void 0:l.detailsUrl,target:"_blank"},N(I(i)("details")),9,ot),c("img",{src:I(nt),alt:""},null,8,ct)]),c("div",dt,[c("div",lt,[c("div",ut,N(I(i)("issued-by")),1),c("div",ft,N(" "+((o=e.data)==null?void 0:o.issued)),1)]),c("div",pt,[c("div",vt,N(I(i)("received-by")),1),c("div",mt,N(" "+((p=e.data)==null?void 0:p.receive)),1)])]),c("div",gt,[c("img",{src:I(ae),alt:"",class:"icon"},null,8,_t),U(" "+N(I(ne)((m=e.data)==null?void 0:m.expire).format("MM/DD/YYYY")+" "+I(i)("expires")),1)]),c("div",ht,[c("div",yt,[c("img",{src:I(re),alt:"",class:"icon"},null,8,bt),U(" "+N(((d=e.data)==null?void 0:d.remain)+"/"+((g=e.data)==null?void 0:g.total))+" ",1),c("img",{src:I(st),alt:"",class:"icon-end"},null,8,St)]),c("div",xt,[c("img",{src:I(ve),alt:"",class:"icon"},null,8,It),U(" "+N((_=e.data)==null?void 0:_.price),1)])]),c("div",Nt,[(B(!0),A(ee,null,ke(e.btns,h=>(B(),A("div",{key:h.type,class:Ce(["btn",h.type]),onClick:h.event},[U(N(h.title)+" ",1),c("img",{src:h.icon,alt:""},null,8,Ct)],10,kt))),128))])])}}});const $t=te(Tt,[["__scopeId","data-v-09427feb"]]),Rt=t=>(Be("data-v-f805c70f"),t=t(),Pe(),t),wt={class:"explore-nft-details"},Lt=Rt(()=>c("div",{style:{height:"89px"}},null,-1)),Ut=M({__name:"index",setup(t){const e=Te(),i=$e(),{cancelNFRsOrder:s,acceptNFRsRequest:y,buyNFR:x}=ce(),{t:l}=Z(),o=Re(),p=L(!1),m=L(),d=L(),g=L(!1),_=L([]),h=async()=>{var r;if(!((r=d.value)!=null&&r.order))return;const{order:f,id:v}=d.value;if(!await s({order:f}))return;(await le(String(v))).code===0&&o.back()},T=async()=>{i.setGlobalLoading(!0);try{await h()}catch(f){console.error(f)}i.setGlobalLoading(!1)},w=async()=>{var b;if(!((b=d.value)!=null&&b.order))return;const{order:f,id:v}=d.value,a=await ue(String(v));if(a.code!==0)return;const n=a.data.nfrTrans.nfrTokenId,r=await y({order:f,orderId:n});await fe(a.data.nfrTrans.id,"submitted"),r&&o.back()},$=async()=>{var f;try{if(!e.currentUser.isLogin){e.setLoginModalVisible(!0);return}if(!((f=d.value)!=null&&f.order))return;const{order:v,id:a}=d.value,n=1,r=await pe(String(a),n);if(r.code!==0)return;const b=r.data.nfrTrans.nfrTokenId;if(!await x({order:v,orderId:b,amount:n}))return;o.back()}catch(v){Ae.error(v.message)}},u=async(f,v)=>{var R,j,z,V;const a=await De(String(f),String(v)),n=e.currentUser.publicKey,r=a.data;let b=`${l("nfr")} - ${r.name}`;o.currentRoute.value.path.indexOf("request")!==-1&&(b=`${l("request-nfr")} -  ${r.name}`),m.value={avatar:r.imageUrl,id:r.tokenId,contractAddress:r.contractAddress,name:b,props:(R=r.traits)==null?void 0:R.map(F=>{const{traitType:se,value:ie}=F;return`${se} ${ie}`}),owner:r.ownerAddressList},g.value=!((z=(j=m.value)==null?void 0:j.owner)!=null&&z.every(F=>F.toLowerCase()!==n.toLowerCase())),g.value?_.value=[{title:l("delist"),type:"vice",icon:X,event:h}]:_.value=[{title:l("buy"),icon:W,event:$}],o.currentRoute.value.path.indexOf("request")!==-1&&(_.value=[],g.value?_.value=[{title:l("accept"),icon:W,event:w}]:((V=d.value)==null?void 0:V.creator).toLowerCase()===n.toLowerCase()&&(_.value=[{title:l("cancel"),type:"vice",icon:X,event:T}]))},C=async()=>{const{id:f}=o.currentRoute.value.params,a=(await de(String(f))).data,{nftTokenAddress:n,nftTokenId:r}=a;d.value={id:a.id,total:a.amount,price:a.unitPrice,receive:a.receive,issued:a.issued,desc:a.description,detailsUrl:a.detailsUrl,remain:a.remain||0,expire:ne(a.createdAt).add(Number(a.duration),"day").valueOf(),order:a.orderOnChain,creator:a.creator},u(n,r)};return we(()=>{C()}),(f,v)=>(B(),A(ee,null,[S(I(P),{spinning:p.value},{default:K(()=>[m.value?(B(),Le(oe,{key:0,data:m.value},{default:K(()=>[c("div",wt,[S($t,{data:d.value,btns:_.value},null,8,["data","btns"])])]),_:1},8,["data"])):Ue("",!0),Lt]),_:1},8,["spinning"]),U("> ")],64))}});const Et=te(Ut,[["__scopeId","data-v-f805c70f"]]);export{Et as default};
